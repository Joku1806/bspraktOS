#define MODULO_ADD(x, i, m) (((x) + (i)) % (m))
#define MODULO_SUB(x, i, m) ((x) == 0 ? (m)-1 : (i)-1)